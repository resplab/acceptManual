<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Using the Package as an API (PRISM) | Acute COPD Exacerbation Prediction Tool (ACCEPT)</title>
  <meta name="description" content="5 Using the Package as an API (PRISM) | Acute COPD Exacerbation Prediction Tool (ACCEPT)" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Using the Package as an API (PRISM) | Acute COPD Exacerbation Prediction Tool (ACCEPT)" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Using the Package as an API (PRISM) | Acute COPD Exacerbation Prediction Tool (ACCEPT)" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-webapp.html">
<link rel="next" href="section-appendix1.html">
<script src="book_assets/jquery-2.2.3/jquery.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="book_assets/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="book_assets/viz-0.3/viz.js"></script>
<link href="book_assets/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="book_assets/grViz-binding-1.0.1/grViz.js"></script>
<script src="book_assets/plotly-binding-4.9.0/plotly.js"></script>
<script src="book_assets/typedarray-0.1/typedarray.min.js"></script>
<link href="book_assets/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="book_assets/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="book_assets/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="book_assets/plotly-main-1.46.1/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/pretty-styles.css" type="text/css" />
<link rel="stylesheet" href="css/cayman.css" type="text/css" />
<link rel="stylesheet" href="css/python.css" type="text/css" />
<link rel="stylesheet" href="css/shadow.css" type="text/css" />
<link rel="stylesheet" href="highlightjs/styles/default.css" type="text/css" />
<link rel="stylesheet" href="index.html" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="section-introduction.html"><a href="section-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="section-thestudy.html"><a href="section-thestudy.html"><i class="fa fa-check"></i><b>2</b> The Study</a><ul>
<li class="chapter" data-level="2.1" data-path="section-thestudy.html"><a href="section-thestudy.html#section-background"><i class="fa fa-check"></i><b>2.1</b> Background</a><ul>
<li class="chapter" data-level="" data-path="section-thestudy.html"><a href="section-thestudy.html#section-exacerbation-causes"><i class="fa fa-check"></i>Exacerbation Causes</a></li>
<li class="chapter" data-level="" data-path="section-thestudy.html"><a href="section-thestudy.html#section-exacerbation-severity"><i class="fa fa-check"></i>Exacerbation Severity</a></li>
<li class="chapter" data-level="" data-path="section-thestudy.html"><a href="section-thestudy.html#section-references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="section-thestudy.html"><a href="section-thestudy.html#section-studyPopulation"><i class="fa fa-check"></i><b>2.2</b> The Study Population</a><ul>
<li class="chapter" data-level="" data-path="section-thestudy.html"><a href="section-thestudy.html#section-clinical-trial-1-macro"><i class="fa fa-check"></i>Clinical Trial 1: MACRO</a></li>
<li class="chapter" data-level="" data-path="section-thestudy.html"><a href="section-thestudy.html#section-clinical-trial-2-statcope"><i class="fa fa-check"></i>Clinical Trial 2: STATCOPE</a></li>
<li class="chapter" data-level="" data-path="section-thestudy.html"><a href="section-thestudy.html#section-clinical-trial-3-optimal"><i class="fa fa-check"></i>Clinical Trial 3: OPTIMAL</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-thestudy.html"><a href="section-thestudy.html#section-combined-trials"><i class="fa fa-check"></i><b>2.3</b> Data Collection: Combined Trials</a><ul>
<li class="chapter" data-level="" data-path="section-thestudy.html"><a href="section-thestudy.html#section-primary-metric"><i class="fa fa-check"></i>Primary Metric</a></li>
<li class="chapter" data-level="" data-path="section-thestudy.html"><a href="section-thestudy.html#section-secondary-metrics"><i class="fa fa-check"></i>Secondary Metrics</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="section-thestudy.html"><a href="section-thestudy.html#section-validation"><i class="fa fa-check"></i><b>2.4</b> Validation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-packageinR.html"><a href="section-packageinR.html"><i class="fa fa-check"></i><b>3</b> Using the Package in R</a><ul>
<li class="chapter" data-level="3.1" data-path="section-packageinR.html"><a href="section-packageinR.html#section-installation"><i class="fa fa-check"></i><b>3.1</b> Installation</a></li>
<li class="chapter" data-level="3.2" data-path="section-packageinR.html"><a href="section-packageinR.html#section-accept-prediction-functions"><i class="fa fa-check"></i><b>3.2</b> ACCEPT Prediction Functions</a><ul>
<li class="chapter" data-level="" data-path="section-packageinR.html"><a href="section-packageinR.html#section-sample-data"><i class="fa fa-check"></i>Sample Data</a></li>
<li class="chapter" data-level="" data-path="section-packageinR.html"><a href="section-packageinR.html#section-exacerbation-rate"><i class="fa fa-check"></i>Exacerbation Rate</a></li>
<li class="chapter" data-level="" data-path="section-packageinR.html"><a href="section-packageinR.html#section-probability-of-n-exacerbations-poisson"><i class="fa fa-check"></i>Probability of N Exacerbations (Poisson)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-webapp.html"><a href="section-webapp.html"><i class="fa fa-check"></i><b>4</b> Using the Web Application</a></li>
<li class="chapter" data-level="5" data-path="section-api.html"><a href="section-api.html"><i class="fa fa-check"></i><b>5</b> Using the Package as an API (PRISM)</a><ul>
<li class="chapter" data-level="5.1" data-path="section-api.html"><a href="section-api.html#section-api-in-excel"><i class="fa fa-check"></i><b>5.1</b> PRISM API in Excel</a><ul>
<li class="chapter" data-level="" data-path="section-api.html"><a href="section-api.html#section-downloading-the-spreadsheet"><i class="fa fa-check"></i>Downloading the Spreadsheet</a></li>
<li class="chapter" data-level="" data-path="section-api.html"><a href="section-api.html#section-setting-the-inputs"><i class="fa fa-check"></i>Setting the Inputs</a></li>
<li class="chapter" data-level="" data-path="section-api.html"><a href="section-api.html#section-running-the-model"><i class="fa fa-check"></i>Running the Model</a></li>
<li class="chapter" data-level="" data-path="section-api.html"><a href="section-api.html#section-results"><i class="fa fa-check"></i>Results</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="section-api.html"><a href="section-api.html#section-api-in-rjavascriptpythonbash"><i class="fa fa-check"></i><b>5.2</b> API in R/Javascript/Python/Bash</a><ul>
<li class="chapter" data-level="" data-path="section-api.html"><a href="section-api.html#section-setting-the-input"><i class="fa fa-check"></i>Setting the Input</a></li>
<li class="chapter" data-level="" data-path="section-api.html"><a href="section-api.html#section-running-the-model-1"><i class="fa fa-check"></i>Running the Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="section-appendix1.html"><a href="section-appendix1.html"><i class="fa fa-check"></i><b>6</b> Appendix 1: Installing R</a><ul>
<li class="chapter" data-level="6.1" data-path="section-appendix1.html"><a href="section-appendix1.html#section-step-1-mirrors"><i class="fa fa-check"></i><b>6.1</b> Step 1: Mirrors</a></li>
<li class="chapter" data-level="6.2" data-path="section-appendix1.html"><a href="section-appendix1.html#section-mac-os-x"><i class="fa fa-check"></i><b>6.2</b> Mac OS X</a></li>
<li class="chapter" data-level="6.3" data-path="section-appendix1.html"><a href="section-appendix1.html#section-windows"><i class="fa fa-check"></i><b>6.3</b> Windows</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Acute COPD Exacerbation Prediction Tool (ACCEPT)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-api" class="section level1">
<h1><span class="header-section-number">5</span> Using the Package as an API (PRISM)</h1>
<p>PRISM (Programmable Interface for Simulation/Statistical Models) is a package which provides a user-friendly API interface in R for clinical prediction and decision analytics models hosted on UBC PRISM cloud.</p>
<p>For more information, the PRISM package can be found on GitHub at <a href="https://github.com/resplab/prism">PRISM on GitHub</a>.</p>
<div id="section-api-in-excel" class="section level2">
<h2><span class="header-section-number">5.1</span> PRISM API in Excel</h2>
<p>One of the primary goals of PRISM is making prediction models accessible to a wide range of audiences, including those with less programming experience. The Excel API is targetted towards users who are less familiar with programming, or users who are familiar with programming and would like an easy way to extract the data quickly.</p>
<p>To use the model, you will need to have Excel installed on your computer. Currently, the Excel API only works in Windows (PC), although we are working on developing a version for Mac (OS X) as well.</p>
<div id="section-downloading-the-spreadsheet" class="section level3 unnumbered">
<h3>Downloading the Spreadsheet</h3>
<p>To get started, you will need to go to:</p>
<p><a href="http://resp.core.ubc.ca/ipress/prism">PRISM Model Repository</a>.</p>
<p>In the row that has the <strong>ACCEPT</strong> model, go to the column labelled <strong>Excel Interface</strong> and click on the link <strong>ACCEPT Excel (PC)</strong>. This will download the Excel Interface for the <strong>ACCEPT</strong> model.</p>
</div>
<div id="section-setting-the-inputs" class="section level3 unnumbered">
<h3>Setting the Inputs</h3>
<p>Once you have downloaded the Excel Interface, you can open it in Excel. You will notice there are two sheets, labelled <strong>Model</strong> and <strong>Settings</strong>. Click on the <strong>Model</strong> tab.</p>
<p>You will notice several tables. The top two tables are input tables, which means that these are values you can change. For each package, we will provide details on what values are allowed. For example, <strong>Gender</strong> can be either <strong>Male</strong> or <strong>Female</strong>.</p>
<div id="section-plot-options" class="section level4 unnumbered">
<h4>Plot Options</h4>
<p>The first table is Plot Options. You may change these if you like, or leave the default values:</p>
<head>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

</head>
<div class="row">
  <div class="col-4">
    <div class="list-group" id="list-tab" role="tablist">
      <a class="list-group-item list-group-item-action active"
      id="list-excel-input-1-list" data-toggle="list" href="#list-excel-input-1" role="tab" aria-controls="excel-input-1">
        Calculate confidence interval?
      </a>
      <a class="list-group-item list-group-item-action" id="list-excel-input-2-list" data-toggle="list"
      href="#list-excel-input-2" role="tab" aria-controls="excel-input-2">
        Error bar
      </a>
    </div>
  </div>
  <div class="col-8">
    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="list-excel-input-1" role="tabpanel" aria-labelledby="list-excel-input-1-list">
      1 = Yes, 0 = No. Whether or not to calculate the 95% confidence interval
      </div>
      <div class="tab-pane fade" id="list-excel-input-2" role="tabpanel" aria-labelledby="list-excel-input-2-list">
        Which error bar to show in the graphs (prediction interval or confidence interval)
      </div>

    </div>
  </div>
</div>
<br>
</div>
<div id="section-patient-characteristics" class="section level4 unnumbered">
<h4>Patient Characteristics</h4>
<p>The second table applies to the patient. You can use the default patient inputs, or change them:</p>
<head><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<div class="row">
  <div class="col-4">

    <div class="list-group" id="list-tab" role="tablist">
      <a class="list-group-item list-group-item-action active" id="list-gender-list" data-toggle="list" href="#list-gender" role="tab" aria-controls="gender">Gender (male or female)</a>
      <a class="list-group-item list-group-item-action" id="list-age-list" data-toggle="list" href="#list-age" role="tab" aria-controls="age">Age (years)</a>
      <a class="list-group-item list-group-item-action" id="list-smoking-list" data-toggle="list" href="#list-smoking" role="tab" aria-controls="smoking">Smoking Status</a>
      <a class="list-group-item list-group-item-action" id="list-oco-list" data-toggle="list" href="#list-oco" role="tab" aria-controls="oco">Oxygen Therapy</a>
      <a class="list-group-item list-group-item-action" id="list-statins-list" data-toggle="list" href="#list-statins" role="tab" aria-controls="statins">Statins</a>
      <a class="list-group-item list-group-item-action" id="list-lama-list" data-toggle="list" href="#list-lama" role="tab" aria-controls="lama">LAMAs</a>
      <a class="list-group-item list-group-item-action" id="list-laba-list" data-toggle="list" href="#list-laba" role="tab" aria-controls="laba">LABAs</a>
      <a class="list-group-item list-group-item-action" id="list-ics-list" data-toggle="list" href="#list-ics" role="tab" aria-controls="ics">Inhaled Corticosteroids</a>
      <a class="list-group-item list-group-item-action" id="list-fev1-list" data-toggle="list" href="#list-fev1" role="tab" aria-controls="fev1">FEV1 % Predicted</a>
      <a class="list-group-item list-group-item-action" id="list-bmi-list" data-toggle="list" href="#list-bmi" role="tab" aria-controls="bmi">BMI</a>
      <a class="list-group-item list-group-item-action" id="list-sgrq-list" data-toggle="list" href="#list-sgrq" role="tab" aria-controls="sgrq">SGRQ Score</a>
      <a class="list-group-item list-group-item-action" id="list-exacerbation-all-list" data-toggle="list" href="#list-exacerbation-all" role="tab" aria-controls="exacerbation-all">
        Number of all exacerbations</a>
      <a class="list-group-item list-group-item-action" id="list-exacerbation-sev-list" data-toggle="list" href="#list-exacerbation-sev" role="tab" aria-controls="exacerbation-sev">
        Number of severe exacerbations</a>

    </div>
  </div>
  <div class="col-8">
    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="list-gender" role="tabpanel" aria-labelledby="list-gender-list">
        For the purpose of this study, we looked at "Male" and "Female" genders.
      </div>
      <div class="tab-pane fade" id="list-age" role="tabpanel" aria-labelledby="list-age-list">
        Patient age in years
      </div>
      <div class="tab-pane fade" id="list-smoking" role="tabpanel" aria-labelledby="list-smoking-list">
        Whether or not a patient currently smokes. Yes = smoker, No = non-smoker
      </div>
      <div class="tab-pane fade" id="list-oco" role="tabpanel" aria-labelledby="list-oco-list">
        Domiciliary Oxygen Therapy: At-home oxygen therapy, used to treat COPD. This metric measures whether or not a patient uses oxygen therapy, Yes or No.
      </div>
      <div class="tab-pane fade" id="list-statins" role="tabpanel" aria-labelledby="list-statins-list">
        Statins: generally used to lower cholesteral in blood, but some studies have recently shown they can be effective in COPD treatment. This metric asks whether or not a patient has used statins in the past year.
      </div>
      <div class="tab-pane fade" id="list-lama" role="tabpanel" aria-labelledby="list-lama-list">
      Long-Acting Muscarinic receptor Antagonists: used for treatment of COPD. This metric asks whether or not a patient has used LAMAs in the past year.
  </div>
  <div class="tab-pane fade" id="list-laba" role="tabpanel" aria-labelledby="list-laba-list">
    Long-Acting β2 Agonists: used for treatment of COPD. This metric asks whether or not a patient has used LABAs in the past year.
  </div>
  <div class="tab-pane fade" id="list-ics" role="tabpanel" aria-labelledby="list-ics-list">
    Inhaled Glucocorticoids (ICs): used for treatment of COPD. This metric asks whether or not a patient has used inhaled glucocorticoids in the past year.
  </div>
  <div class="tab-pane fade" id="list-fev1" role="tabpanel" aria-labelledby="list-fev1-list">
    Prediction % FEV1 Score.
  </div>
  <div class="tab-pane fade" id="list-bmi" role="tabpanel" aria-labelledby="list-bmi-list">
    Body Mass Index: ratio of weight (kg) to height squared (m^2)
</div>

        <div class="tab-pane fade" id="list-sgrq" role="tabpanel" aria-labelledby="list-sgrq-list">
          St. George's Respiratory Questionnaire: This questionnaire is to help doctors/patients determine how much COPD is affecting day-to-day life. The score from the questionnaire is correlated to cough, sputum, and wheezing symptoms.
          <a href="http://www.healthstatus.sgul.ac.uk/SGRQ_download/Original%20English%20version.pdf">
            Questionnaire Download
          </a><br>
          <a href="https://www.thoracic.org/members/assemblies/assemblies/srn/questionaires/sgrq.php">
            SGRQ Overview
            </a>
    </div>
      <div class="tab-pane fade" id="list-exacerbation-all" role="tabpanel" aria-labelledby="list-exacerbation-all-list">
        Number of exacerbations (severe and mild/moderate) in the last year.
      </div>
      <div class="tab-pane fade" id="list-exacerbation-sev" role="tabpanel" aria-labelledby="list-exacerbation-sev-list">
        Number of severe exacerbations in the last year.
      </div>

    </div>
  </div>
</div>
<br>
</div>
</div>
<div id="section-running-the-model" class="section level3 unnumbered">
<h3>Running the Model</h3>
<p>To run the model, you need to connect to the model first.</p>
<ol style="list-style-type: decimal">
<li>Click on the <strong>Output - Main Outcomes</strong> sheet.</li>
<li>There is a button at the top of the page which says <strong>Connect to Model</strong>. Click on that button. On the bottom left of the Excel window, you should see the text “Connecting to model…”</li>
<li>Click on the <strong>Run</strong> button.</li>
<li>Click on the <strong>Disconnect from Model</strong> button once it has finished running.</li>
</ol>
</div>
<div id="section-results" class="section level3 unnumbered">
<h3>Results</h3>
<p>Once you have run the model, there are several graphs which will be plotted in the same sheet to visualize the results.</p>
</div>
</div>
<div id="section-api-in-rjavascriptpythonbash" class="section level2">
<h2><span class="header-section-number">5.2</span> API in R/Javascript/Python/Bash</h2>
<p>To get started, you will need to install a few packages:</p>
<script src="js/code-chunk-component.js"></script>
<code-chunk>
  <div slot="code">
    <div class="code-chunk">
      <code class="code mac">
      brew install curl </code>
      <code class="code linux">
      sudo apt install curl</code>
        <code class="code windows">
<br>
        </code>
    <code class="code js">
    </code>
    <code class="code r active">
      install.packages("devtools")<br>
      devtools::install_github("resplab/prism")<br>
    </code>
    <code class="code python">
      pip3 install requests<br>
    </code></div>
  </div>
</code-chunk>
<br>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<script src="js/list-group.js"></script>
<script src="js/code-chunk.js"></script>
<p>The next step is to get an API key. For now, we will be giving out API keys on a case-by-case basis, so please email either:</p>
<p>Amin Adibi: <a href="mailto:amin.adibi@ubc.ca" class="email">amin.adibi@ubc.ca</a></p>
<p>Mohsen Sadatsafavi: <a href="mailto:mohsen.sadatsafavi@ubc.ca" class="email">mohsen.sadatsafavi@ubc.ca</a></p>
<div id="section-setting-the-input" class="section level3 unnumbered">
<h3>Setting the Input</h3>
<p>To run the model, you can either use the default input, or set your own input. To see what the default input is, you can use the following <code>POST</code> call:</p>
<code-chunk>
  <div slot="code">
    <div class="code-chunk">
    <code class="code mac">
      curl -X POST -H "Content-Type: application/json" -d '{"api_key":["YOUR_API_KEY"],"func":["get_default_input"]}'<br>
      http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json </code>
      <code class="code linux">
        curl -X POST -H "Content-Type: application/json" -d '{"api_key":["YOUR_API_KEY"],"func":["get_default_input"]}'<br>
        http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json<br>
      </code>
        <code class="code windows">
<br>
        </code>
    <code class="code js">
      let arguments = JSON.stringify({<br>
        api_key: 'YOUR_API_KEY',<br>
        func: ["get_default_input"]<br>
      }); <br><br>
      request = new XMLHttpRequest();<br>
      request.open('POST', 'http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json');<br>
      request.setRequestHeader('Content-Type', 'application/json');<br>
      request.send(arguments);<br>
      let results = request.response;<br>
    </code>
    <code class="code r active">
      library(prism)<br>
      connect_to_model('acceptPrism', api_key = YOUR_API_KEY)<br>
      input = get_default_input()<br>
    </code>
    <code class="code python">
      import json<br>
      import requests<br>
      api_key = 'YOUR_API_KEY'<br>
      response = requests.post("http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json",<br>
        json = {"api_key":[api_key],<br>
        "func": ["get_default_input"]})<br>
      print(response)<br>
      results = json.loads(response.text)<br>
      print(results)<br>
    </code>
</div></div></code-chunk>
<br>
</div>
<div id="section-running-the-model-1" class="section level3 unnumbered">
<h3>Running the Model</h3>
<p>To run the model with the default input, you can use the following <code>POST</code> call:</p>
<code-chunk>
  <div slot="code">
    <div class="code-chunk">

    <code class="code mac">
      curl -X POST -H "Content-Type: application/json" -d '{"api_key":["YOUR_API_KEY"],"func":["prism_model_run"],<br>
"model_input":[{}]}' http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json </code>
      <code class="code linux">
      curl -X POST -H "Content-Type: application/json" -d '{"api_key":["YOUR_API_KEY"],"func":["prism_model_run"],<br>
"model_input":[{}]}' http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json<br>
<br>
}]}' http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json<br>
      </code>
        <code class="code windows">
          curl -Body '{"api_key":["YOUR_API_KEY"],"func":["prism_model_run"],"model_input":[{}]}' -Method POST -uri http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json -Headers @{"Content-type"="application/json"}<br>
        </code>
    <code class="code js">
      let postData = JSON.stringify({<br>
	"api_key": "YOUR_API_KEY",<br>
	"func": ["prism_model_run"],<br>
	"model_input": [{}]<br>
});<br>
request.open('POST', 'http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json');<br>
request.setRequestHeader('Content-Type', 'application/json');<br>
request.send(postData);<br>
let results = request.response;<br>
    </code>
    <code class="code r active">
      library(prism)<br>
      connect_to_model('acceptPrism', api_key = YOUR_API_KEY)<br>
      results = model_run()<br>
    </code>
    <code class="code python">
      api_key = 'YOUR_API_KEY'<br>
modelInput = [{}]<br>
      response = requests.post("http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json",<br>
      json = {"api_key":[api_key],<br>
        "func": ["prism_model_run"],<br>
        "model_input": modelInput})<br>
      print(response)<br>
  results = json.loads(response.text)<br>
  print(results)<br>
    </code>
</div>
</div>
</code-chunk>
<p>To set your own input:</p>
<code-chunk>
  <div slot="code">
    <div class="code-chunk">

    <code class="code mac">
      curl -X POST -H "Content-Type: application/json" -d '{<br>
        "api_key":["YOUR_API_KEY"],<br>
        "func":["prism_model_run"],<br>
        "model_input": {<br>
          "patient_data": {<br>
			       "ID": "10001",<br>
			       "male": 1,<br>
			       "age": 70,<br>
			       "smoker": 1,<br>
			       "oxygen": 1,<br>
			       "statin": 1,<br>
			       "LAMA": 1,<br>
			       "LABA": 1,<br>
			       "ICS": 1,<br>
			       "FEV1": 33,<br>
			       "BMI": 25,<br>
			       "SGRQ": 50,<br>
			       "LastYrExacCount": 2,<br>
			       "LastYrSevExacCount": 1,<br>
			       "randomized_azithromycin": 0,<br>
			       "randomized_statin": 0,<br>
			       "randomized_LAMA": 0,<br>
			       "randomized_LABA": 0,<br>
			       "randomized_ICS": 0<br>
		      },<br>
		     "random_sampling_N": 1000,<br>
		     "calculate_CIs": true,<br>
		     "random_distribution_iteration": 20000}}' http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json<br>
       </code>
      <code class="code linux">
      curl -X POST -H "Content-Type: application/json" -d '{<br>
        "api_key":["YOUR_API_KEY"],<br>
        "func":["prism_model_run"],<br>
        "model_input": {<br>
          "patient_data": {<br>
			       "ID": "10001",<br>
			       "male": 1,<br>
			       "age": 70,<br>
			       "smoker": 1,<br>
			       "oxygen": 1,<br>
			       "statin": 1,<br>
			       "LAMA": 1,<br>
			       "LABA": 1,<br>
			       "ICS": 1,<br>
			       "FEV1": 33,<br>
			       "BMI": 25,<br>
			       "SGRQ": 50,<br>
			       "LastYrExacCount": 2,<br>
			       "LastYrSevExacCount": 1,<br>
			       "randomized_azithromycin": 0,<br>
			       "randomized_statin": 0,<br>
			       "randomized_LAMA": 0,<br>
			       "randomized_LABA": 0,<br>
			       "randomized_ICS": 0<br>
		      },<br>
		     "random_sampling_N": 1000,<br>
		     "calculate_CIs": true,<br>
		     "random_distribution_iteration": 20000}}' http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json<br>
      </code>
        <code class="code windows">
          curl -Body '{<br>
            "api_key":["YOUR_API_KEY"],<br>
            "func":["prism_model_run"],<br>
            "model_input": {<br>
              "patient_data": {<br>
    			       "ID": "10001",<br>
    			       "male": 1,<br>
    			       "age": 70,<br>
    			       "smoker": 1,<br>
    			       "oxygen": 1,<br>
    			       "statin": 1,<br>
    			       "LAMA": 1,<br>
    			       "LABA": 1,<br>
    			       "ICS": 1,<br>
    			       "FEV1": 33,<br>
    			       "BMI": 25,<br>
    			       "SGRQ": 50,<br>
    			       "LastYrExacCount": 2,<br>
    			       "LastYrSevExacCount": 1,<br>
    			       "randomized_azithromycin": 0,<br>
    			       "randomized_statin": 0,<br>
    			       "randomized_LAMA": 0,<br>
    			       "randomized_LABA": 0,<br>
    			       "randomized_ICS": 0<br>
    		      },<br>
    		     "random_sampling_N": 1000,<br>
    		     "calculate_CIs": true,<br>
    		     "random_distribution_iteration": 20000}}' -Method POST -uri http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json -Headers @{"Content-type"="application/json"}<br>
        </code>
    <code class="code js">
      let postData = JSON.stringify({<br>
        "api_key":["YOUR_API_KEY"],<br>
        "func":["prism_model_run"],<br>
        "model_input": {<br>
          "patient_data": {<br>
             "ID": "10001",<br>
             "male": 1,<br>
             "age": 70,<br>
             "smoker": 1,<br>
             "oxygen": 1,<br>
             "statin": 1,<br>
             "LAMA": 1,<br>
             "LABA": 1,<br>
             "ICS": 1,<br>
             "FEV1": 33,<br>
             "BMI": 25,<br>
             "SGRQ": 50,<br>
             "LastYrExacCount": 2,<br>
             "LastYrSevExacCount": 1,<br>
             "randomized_azithromycin": 0,<br>
             "randomized_statin": 0,<br>
             "randomized_LAMA": 0,<br>
             "randomized_LABA": 0,<br>
             "randomized_ICS": 0<br>
          },<br>
         "random_sampling_N": 1000,<br>
         "calculate_CIs": true,<br>
         "random_distribution_iteration": 20000}});<br>
request.open('POST', 'http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json');<br>
request.setRequestHeader('Content-Type', 'application/json');<br>
request.send(postData);<br>
let results = request.response;<br>
    </code>
    <code class="code r active">
      library(prism)<br>
      connect_to_model('acceptPrism', api_key = YOUR_API_KEY)<br>
      model_input = list(patient_data = samplePatients)<br>
      model_input$random_sampling_N = 1000<br>
      model_input$random_distribution_iteration = 20000<br>
      model_input$calculate_CIs = TRUE<br>
      model_run(model_input)<br>
      results = model_run(model_input)<br>
    </code>
    <code class="code python">
      api_key = 'YOUR_API_KEY'<br>
modelInput = {<br>
  "patient_data": {<br>
    "ID": "10001",<br>
    "male": 1,<br>
    "age": 70,<br>
    "smoker": 1,<br>
    "oxygen": 1,<br>
    "statin": 1,<br>
    "LAMA": 1,<br>
    "LABA": 1,<br>
    "ICS": 1,<br>
    "FEV1": 33,<br>
    "BMI": 25,<br>
    "SGRQ": 50,<br>
    "LastYrExacCount": 2,<br>
    "LastYrSevExacCount": 1,<br>
    "randomized_azithromycin": 0,<br>
    "randomized_statin": 0,<br>
    "randomized_LAMA": 0,<br>
    "randomized_LABA": 0,<br>
    "randomized_ICS": 0<br>
  },<br>
  "random_sampling_N": 1000,<br>
  "calculate_CIs": True,<br>
  "random_distribution_iteration": 20000<br>
}<br>
      response = requests.post("http://prism.resp.core.ubc.ca/ocpu/library/acceptPrism/R/gateway/json",<br>
      json = {"api_key":[api_key],<br>
        "func": ["prism_model_run"],<br>
        "model_input": modelInput})<br>
      print(response)<br>
  results = json.loads(response.text)<br>
  print(results)<br>
    </code>
</div>
</div>
</code-chunk>
<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.9/styles/default.min.css">
<link rel="stylesheet"
            href="default.css">
<script src="js/highlight.pack.js"></script>
  <script>
    /*
Applies highlighting to all <pre><code>..</code></pre> blocks on a page.
*/
hljs.configure({useBR: true});
$("code-chunk code").each(function (i, e) {
    hljs.highlightBlock(e);
});
/*hljs.initHighlightingOnLoad();*/
  </script>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-webapp.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-appendix1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
